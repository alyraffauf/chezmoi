#!/usr/bin/env bash

# GNOME settings hash: {{ include ".chezmoidata/gnome.json" | sha256sum }}

# Only run on Linux with GNOME
{{ if eq .chezmoi.os "linux" }}
if [[ "$XDG_CURRENT_DESKTOP" == *"GNOME"* ]] && command -v dconf &> /dev/null; then
    {{ range $setting := (include ".chezmoidata/gnome.json" | mustFromJson).settings }}
    if dconf write {{ $setting.key | quote }} {{ $setting.value | quote }} 2>/dev/null; then
        echo "[gnome] {{ $setting.key }} = {{ $setting.value }}"
    else
        echo "[gnome] ERROR: {{ $setting.key }} failed to set"
    fi
    {{ end }}
fi
{{ end }}
